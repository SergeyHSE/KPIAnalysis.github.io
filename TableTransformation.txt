let
    Источник = Excel.Workbook(File.Contents(".....Your Path....."), null, true),
    #"Хим обработка 2023_Sheet" = Источник{[Item="Хим обработка 2023",Kind="Sheet"]}[Data],
    #"Измененный тип" = Table.TransformColumnTypes(#"Хим обработка 2023_Sheet",{{"Column1", type text}, {"Column2", type any}, {"Column3", type any}, {"Column4", type any}, {"Column5", type any}, {"Column6", type any}, {"Column7", type any}, {"Column8", type any}, {"Column9", type any}, {"Column10", type any}, {"Column11", type any}, {"Column12", type any}, {"Column13", type any}, {"Column14", type any}, {"Column15", type any}, {"Column16", type any}, {"Column17", type any}, {"Column18", type any}, {"Column19", type any}, {"Column20", type any}, {"Column21", type any}, {"Column22", type any}, {"Column23", type any}, {"Column24", type any}, {"Column25", type any}, {"Column26", type any}, {"Column27", type any}, {"Column28", type any}, {"Column29", type any}, {"Column30", type any}, {"Column31", type any}, {"Column32", type any}, {"Column33", type any}, {"Column34", type any}, {"Column35", type any}, {"Column36", type any}, {"Column37", type any}, {"Column38", type any}, {"Column39", type any}, {"Column40", type any}, {"Column41", type any}, {"Column42", type any}, {"Column43", type any}, {"Column44", type any}, {"Column45", type any}, {"Column46", type any}, {"Column47", type any}, {"Column48", type any}}),
    #"Строки с применным фильтром" = Table.SelectRows(#"Измененный тип", each ([Column1] <> "" and [Column1] <> "2022")),
    #"Удаленные столбцы" = Table.RemoveColumns(#"Строки с применным фильтром",{"Column2", "Column3", "Column4", "Column5", "Column6", "Column1", "Column8", "Column9", "Column10"}),
    #"Удаленные верхние строки" = Table.Skip(#"Удаленные столбцы",6),
    #"Повышенные заголовки" = Table.PromoteHeaders(#"Удаленные верхние строки"),
    #"Объединенные столбцы" = Table.CombineColumns(Table.TransformColumnTypes(#"Повышенные заголовки", {{"Обработка №1/препарат №1/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №1/фактическая доза препарата, л,кг, дозы/га", type text}}, "ru-RU"),{"Обработка №1/препарат №1/наименование препарата", "Обработка №1/препарат №1/группа препарата", "Обработка №1/препарат №1/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №1/фактическая доза препарата, л,кг, дозы/га"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено"),
    #"Объединенные столбцы1" = Table.CombineColumns(Table.TransformColumnTypes(#"Объединенные столбцы", {{"Обработка №1/препарат №2/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №2/фактическая доза препарата, л,кг, дозы/га", type text}}, "ru-RU"),{"Обработка №1/препарат №2/наименование препарата", "Обработка №1/препарат №2/группа препарата", "Обработка №1/препарат №2/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №2/фактическая доза препарата, л,кг, дозы/га"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено.1"),
    #"Объединенные столбцы2" = Table.CombineColumns(Table.TransformColumnTypes(#"Объединенные столбцы1", {{"Обработка №1/препарат №3/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №3/фактическая доза препарата, л,кг, дозы/га", type text}}, "ru-RU"),{"Обработка №1/препарат №3/наименование препарата", "Обработка №1/препарат №3/группа препарата", "Обработка №1/препарат №3/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №3/фактическая доза препарата, л,кг, дозы/га"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено.2"),
    #"Объединенные столбцы3" = Table.CombineColumns(Table.TransformColumnTypes(#"Объединенные столбцы2", {{"Обработка №1/препарат №4/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №4/фактическая доза препарата, л,кг, дозы/га", type text}}, "ru-RU"),{"Обработка №1/препарат №4/наименование препарата", "Обработка №1/препарат №4/группа препарата", "Обработка №1/препарат №4/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №4/фактическая доза препарата, л,кг, дозы/га"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено.3"),
    #"Объединенные столбцы4" = Table.CombineColumns(Table.TransformColumnTypes(#"Объединенные столбцы3", {{"Обработка №1/препарат №5/наименование препарата", type text}, {"Обработка №1/препарат №5/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №5/фактическая доза препарата, л,кг, дозы/га", type text}}, "ru-RU"),{"Обработка №1/препарат №5/наименование препарата", "Обработка №1/препарат №5/группа препарата", "Обработка №1/препарат №5/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №5/фактическая доза препарата, л,кг, дозы/га"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено.4"),
    #"Объединенные столбцы5" = Table.CombineColumns(Table.TransformColumnTypes(#"Объединенные столбцы4", {{"Обработка №1/препарат №6/наименование препарата", type text}, {"Обработка №1/препарат №6/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №6/фактическая доза препарата, л,кг, дозы/га", type text}}, "ru-RU"),{"Обработка №1/препарат №6/наименование препарата", "Обработка №1/препарат №6/группа препарата", "Обработка №1/препарат №6/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №6/фактическая доза препарата, л,кг, дозы/га"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено.5"),
    #"Объединенные столбцы6" = Table.CombineColumns(Table.TransformColumnTypes(#"Объединенные столбцы5", {{"Обработка №1/препарат №7/наименование препарата", type text}, {"Обработка №1/препарат №7/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №7/фактическая доза препарата, л,кг, дозы/га", type text}}, "ru-RU"),{"Обработка №1/препарат №7/наименование препарата", "Обработка №1/препарат №7/группа препарата", "Обработка №1/препарат №7/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №7/фактическая доза препарата, л,кг, дозы/га"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено.6"),
    #"Объединенные столбцы7" = Table.CombineColumns(Table.TransformColumnTypes(#"Объединенные столбцы6", {{"Обработка №1/препарат №8/наименование препарата", type text}, {"Обработка №1/препарат №8/израсходовано препарата на опрыскивание, л,кг, дозы", type text}, {"Обработка №1/препарат №7/фактическая доза препарата, л,кг, дозы/га2", type text}}, "ru-RU"),{"Обработка №1/препарат №8/наименование препарата", "Обработка №1/препарат №8/группа препарата", "Обработка №1/препарат №8/израсходовано препарата на опрыскивание, л,кг, дозы", "Обработка №1/препарат №7/фактическая доза препарата, л,кг, дозы/га2"},Combiner.CombineTextByDelimiter("|", QuoteStyle.None),"Сведено.7"),
    #"Несвернутые столбцы" = Table.UnpivotOtherColumns(#"Объединенные столбцы7", {"Культура", "Обработка №1/дата начала работ", "Обработка №1/дата завершения работ", "Обработка №1/фактически обработаная площадь, га", "Обработка №1/Вид работ", "Обработка №1/Самохоный опрыскиватель или Трактор (марка, модель, инв.номер)", "Обработка №1/прицепной опрыскиватель (марка, модель, инв.номер)"}, "Атрибут", "Значение"),
    #"Разделить столбец разделителем" = Table.SplitColumn(#"Несвернутые столбцы","Значение",Splitter.SplitTextByDelimiter("|"),{"Значение.1", "Значение.2", "Значение.3", "Значение.4"}),
    #"Измененный тип1" = Table.TransformColumnTypes(#"Разделить столбец разделителем",{{"Значение.1", type text}, {"Значение.2", type text}, {"Значение.3", type number}, {"Значение.4", type number}})
in
    #"Измененный тип1"